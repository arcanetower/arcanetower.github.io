<!DOCTYPE html>
<html style="height: 100%; margin: 0;">
  <head>
    <title>Malendyr Map</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="scripts/leaflet/leaflet.css">
    <script src="scripts/leaflet/leaflet.js"></script>
    <script type="text/javascript" src="scripts/leaflet-hash-master/leaflet-hash.js"></script>
    <script src="scripts/leaflet.measure-master/leaflet.measure.js"></script>
    <link rel="stylesheet" href="scripts/sidebar-v2-master/css/leaflet-sidebar.css">
  </head>
  <body style="height: 100%; margin: 0;">
    <div id="sidebar" class="sidebar collapsed">
        <!-- Nav tabs -->
        <div class="sidebar-tabs">
            <ul role="tablist">
                <li><a href="#home" role="tab"><i class="fa fa-bars"></i></a></li>
                <li><a href="#travel" role="tab"><i class="fa fa-map-marker"></i></a></li>
            </ul>
        </div>

        <!-- Tab panes -->
        <div class="sidebar-content">
            <div class="sidebar-pane" id="home">
                <h1 class="sidebar-header">
                    World Map
                    <span class="sidebar-close"><i class="fa fa-caret-left"></i></span>
                </h1>
                <p>Welcome to the world of <u>Malendyr</u> an ever expanding and wonderous world full of creatures and places worth exploring.</p>

                <p>The world is currently centered on the main location of the campaign. The Tower of the Arcane Arts. This is home to many a magic user where they spend their time helping those in the surrounding area as well as expanding their current arcane understanding.</p>

                <p>In order to navigate the map there are a couple of things that you need to be aware of. Firstly you can pan around using the mouse or your finger (if on a mobile device) to view different parts of the map. Secondly you can also zoom in or out by using the scroll wheel, buttons in the top right of the map, or pinching with your fingers (if on a mobile device). If you select one of the icons on display it will show you more information about the town or location that you have chosen. To close the marker simply click outside of the marker and it will dissapear. The icons will dissapear if you zoom out to far and will reappear once you zoom in close enough. Next to the zoom controls are two other buttons. The first is the measure button, and the second being the layer button.</p>

                <p><b>Layer Controls</b></p>
                <p> The layer controls button allows you to turn off or on various overlays. The top three options allow you to see the boundries between the states as well as the nations, selecting either one will show the area of land that each nation owns. By selecting 'None' it will remove all selections. If you need to remove the icons displayed on the screen for any reason you can do so by selecting the check box next to 'icons' in the Layer Controls box

                <p><b>Measuring</b></p>
                <p>The measure button allows you to see the distance between points that you place on the map. This is helpful for calculating the travel time between locations. It is important that you turn off the icons before measuring as otherwise you won't be able to click directly on the city. Once the icons are turned of simply click on the start of your journey and continue clicking in different locations, it will show you in miles how far between the two points, as you add more points it will continue to show you the distance to the individual points from the origin. You can also activate the measure tool by pressin 'm' on your keyboard. To exit the measrurement that you had completed just press escape on your keyboard or press the measure button again. To bring back the icons simply zoom in or out to an appropriate level or turn them on in the layer controls.</p>
            </div>

            <div class="sidebar-pane" id="travel">
              <h1 class="sidebar-header">Travel times<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
              <p>Wondering how long it will take you to get from one location to the next, simple use the measure tool (or press 'm' on your keyboard) to find out the total amount of miles. The tooltip will then show you the distance and how long it will take to get there depending on the speed that you are travelling. You are only able to go as fast as the slowest member of your party.</p>
              <p><b>Fast:</b></p>
              <p>While travelling at a fast pace you have a -5 penalty to passive Wisdom (Perception) scores. You are able to travel 4 miles an hour or 30 miles a day (assuming 8 hours of travel time a day).</p>
              <p><b>Normal:</b></p>
              <p> While travelling at a normal pace you are able to travel 3 miles an hour or 24 miles a day (assuming 8 hours of travel time a day).</p>
              <p><b>Slow:</b></<p>
              <p> While travelling at a slow pace you are able to use Stealth. You are able to travel 2 miles an hour or 18 miles a day (assuming 8 hours of travel time a day).</p>
              <p><b>Forced March:</b></<p>
              <p>The Travel Pace table assumes that characters Travel for 8 hours in day. They can push on beyond that limit, at the risk of Exhaustion. For each additional hour of Travel beyond 8 hours, the characters cover the distance shown in the Hour column for their pace, and each character must make a Constitution saving throw at the end of the hour. The DC is 10 + 1 for each hour past 8 hours. On a failed saving throw, a character suffers one level of Exhaustion.</p>
            </div>
        </div>
    </div>
    <div id="map" style="width: 100%; height: 100%; background: #888888; margin: 0; class="sidebar-map""></div>
    <script type ="text/javascript" src="scripts/sidebar-v2-master/js/leaflet-sidebar.js"></script>
    <script type="text/javascript">
      var mapSW = [0, 16384],
          mapNE = [16384, 0];

      var underdark = L.tileLayer('maps/underdark/{z}/{x}/{y}.jpg', {minZoom: 0, maxZoom: 6, noWrap: true, zoomControl: false});

      var overworld = L.tileLayer('maps/world_6/{z}/{x}/{y}.png', {minZoom: 0, maxZoom: 6, noWrap: true, zoomControl: false});

      var map = L.map('map', {layers: [underdark, overworld]}).setView([-11.346192, -83.034668], 6);

        L.control.zoom({
          position:'topright',
        }).addTo(map);

        map.setMaxBounds(new L.LatLngBounds(
          map.unproject(mapSW, map.getMaxZoom()),
          map.unproject(mapNE, map.getMaxZoom())
        ));

    //Load measure plugin and set options
    var plugin = L.control.measure({
      keyboard: true,
      activeKeyCode: 'M'.charCodeAt(0),
      cancelKeyCode: 27,
      lineColor: 'red',
      lineWeight: 2,
      lineDashArray: '6, 6',
      lineOpacity: 1,
      formatDistance: function (val) {
        return Math.ceil(Math.round(1000 * val / 1609.344) / 6500) + 'mi ' + 'F:' + Math.round((Math.round(1000 * val / 1609.344) / 6500)/30*10)/10 + 'days ' +'N:' + Math.round((Math.round(1000 * val / 1609.344) / 6500)/24*10)/10 + 'days ' + 'S:' + Math.round((Math.round(1000 * val / 1609.344) / 6500)/18*10)/10 + 'days ';
      },
      position: 'topright',
      textColor: 'white',
    }).addTo(map);

    //Load the script to allow the map view to be controlled via url
    var hash = new L.Hash(map);

    var sidebar = L.control.sidebar('sidebar').addTo(map);

    //Icons
    var tower = L.icon({
      iconUrl: 'images/markers/tower.png',
      iconSize: [30, 41],
      iconAnchor: [15, 41],
      popupAnchor: [0, -30],
      shadowUrl: 'images/markers/tower_shadow.png',
      shadowSize: [23.6, 41],
      shadowAnchor: [5, 38]
    });

    var port_town = L.icon({
      iconUrl: 'images/markers/port_town.png',
      iconSize: [25, 22.9],
      iconAnchor: [8, 14],
      popupAnchor: [5 , -5],
      shadowUrl: 'images/markers/port_town_shadow.png',
      shadowSize: [25, 22.9],
      shadowAnchor: [6, 14]
    });

    var town = L.icon({
      iconUrl: 'images/markers/town.png',
      iconSize: [25, 22.9],
      iconAnchor: [8, 14],
      popupAnchor: [5, -5],
      shadowUrl: 'images/markers/town_shadow.png',
      shadowSize: [25, 22.9],
      shadowAnchor: [6, 14]
    });

    var port_city = L.icon({
      iconUrl: 'images/markers/port_city.png',
      iconSize: [25, 22.9],
      iconAnchor: [8, 14],
      popupAnchor: [5, -5],
      shadowUrl: 'images/markers/port_city_shadow.png',
      shadowSize: [25, 22.9],
      shadowAnchor: [6, 14]
    });

    var city = L.icon({
      iconUrl: 'images/markers/city.png',
      iconSize: [25, 22.9],
      iconAnchor: [8, 14],
      popupAnchor: [5, -5],
      shadowUrl: 'images/markers/city_shadow.png',
      shadowSize: [25, 22.9],
      shadowAnchor: [6, 14]
    });

    var tree = L.icon({
      iconUrl: 'images/markers/tree.png',
      iconSize: [25, 25],
      iconAnchor: [15, 41],
      popupAnchor: [0, -30],
      shadowUrl: 'images/markers/tree_shadow.png',
      shadowSize: [25, 25],
      shadowAnchor: [12, 41]
    });
    //Nation Polygons
    var prusha_nation_lines = [[-16.301581, -82.683105],[-15.264914, -78.837891],[-14.009886, -77.937012],[-14.073873, -75.432129],[-12.962308, -74.025879],[-9.620999, -73.586426],[-8.078647, -74.729004],[-7.991567, -75.52002],[-8.426775, -76.662598],[-6.115192, -81.166992],[-6.857915, -85.166016],[-6.83917, -88.109269],[-5.575834, -90.98877],[-4.19303, -93.095762],[-3.688855, -95.731793],[-3.491489, -98.371485],[-5.441022, -101.161284],[-9.18887, -103.595953],[-12.254128, -103.881523],[-15.178181, -103.029172],[-19.911384, -99.338728],[-19.78738, -95.911888],[-17.20377, -92.110005],[-16.488765, -89.185648]];

    var ducan_empire_lines = [[-59.691901, 10.063477],[-63.255173, 13.666053],[-66.374324, 17.136827],[-68.753733, 21.881684],[-70.260774, 22.40889],[-71.581768, 17.6201],[-72.436716, 6.241231],[-71.484329, -1.051789],[-69.241966, -11.156576],[-65.93015, -14.012276],[-63.509375, -19.20275],[-62.975198, -29.439338],[-57.20771, -39.412323],[-56.022948, -50.358475],[-53.383328, -60.902601],[-46.225453, -62.308484],[-42.875964, -55.76234],[-40.5472, -48.557187],[-34.813803, -46.184759],[-31.952162, -39.81435],[-32.472695, -35.860303],[-33.797409, -29.226291],[-36.668419, -27.468937],[-38.479395, -27.205333],[-39.67337, -25.22831],[-39.943436, -23.251286],[-39.402244, -21.625734],[-39.266284, -20.527387],[-40.747257, -19.604776],[-42.358544, -19.165438],[-43.261206, -17.14448],[-47.457809, -12.838963],[-50.34546, -8.13804],[-51.6998, -4.359728],[-56.36525, 5.086051]]

    var vrecia_dynasty_lines = [[3.904204, -57.349203],[-0.028652, -57.348633],[-5.485796, -55.943319],[-8.407301, -55.767584],[-16.549518, -46.320834],[-20.46462, -36.831121],[-30.442475, -24.881112],[-32.466017, -22.508684],[-41.631536, -1.596169],[-47.567095, 16.065241],[-48.565238, 20.72223],[-39.631355, 34.868931],[-33.79043, 39.086582],[-28.376046, 46.81894],[-20.793539, 56.660124],[-16.21233, 58.856817],[-12.639055, 53.321151],[-6.228601, 46.467469],[2.632412, 40.053126],[10.482113, 33.287313],[20.37745, 29.333266],[20.37745, 29.333266],[18.555037, 13.165607],[17.636351, 10.35384],[21.280774, 6.575528],[14.767982, -1.244698],[6.22348, -6.077422],[4.035817, -19.784785],[11.517093, -30.416778],[11.430986, -45.090686],[6.834534, -57.919372]]

    var krurian_kingdom_lines = [[-19.911384, -99.338728],[-19.78738, -95.911888],[-17.20377, -92.110005],[-16.488765, -89.185648],[-19.787293, -80.529785],[-27.102532, -80.024414],[-38.144547, -86.923828],[-43.656388, -83.979492],[-45.088103, -104.633789],[-45.274886, -115.048828],[-47.190053, -130.957031],[-47.547424, -149.326172],[-47.219927, -157.807617],[-43.130903, -158.554688],[-38.579698, -160.048828],[-33.057462, -157.939453],[-22.539417, -154.423828],[-11.587878, -148.886719],[-8.905373, -139.350586],[-7.251088, -129.243164],[-6.421573, -118.696289],[-6.771017, -108.94043],[-9.18887, -103.595953],[-12.254128, -103.881523],[-15.178181, -103.029172]]

    // State Polygons
    var shah_state_lines = [[-13.710035, -89.866623],[-16.488765, -89.185648],[-16.301581, -82.683105],[-15.264914, -78.837891],[-14.009886, -77.937012],[-12.576354, -78.09082],[-11.802719, -78.134766],[-11.177916, -78.354492],[-10.638206, -78.134766],[-9.7727, -77.980957],[-9.295697, -77.453613],[-8.883215, -77.036133],[-8.426775, -76.662598],[-6.814257, -79.628906],[-6.115192, -81.166992],[-6.857915, -85.166016],[-6.83917, -88.109269],[-10.552622, -90.327929]];

    var bertol_state_lines = [[-7.991567, -75.52002],[-8.078647, -74.729004],[-9.620999, -73.586426],[-12.962308, -74.025879],[-14.073873, -75.432129],[-14.009886, -77.937012],[-12.576354, -78.09082],[-11.802719, -78.134766],[-11.177916, -78.354492],[-10.638206, -78.134766],[-9.7727, -77.980957],[-9.295697, -77.453613],[-8.883215, -77.036133],[-8.426775, -76.662598]];

    var merback_state_lines = [[-10.552622, -90.327929],[-13.710035, -89.866623],[-16.488765, -89.185648],[-17.20377, -92.110005],[-19.78738, -95.911888],[-19.911384, -99.338728],[-15.178181, -103.029172],[-12.254128, -103.881523],[-9.18887, -103.595953],[-5.441022, -101.161284],[-3.491489, -98.371485],[-3.688855, -95.731793],[-4.19303, -93.095762],[-5.575834, -90.98877],[-6.83917, -88.109269]]

    var iron_state_lines = [[-9.620999, -73.586426],[-12.962308, -74.025879],[-14.008696, -72.930122],[-13.774066, -71.590139],[-13.068777, -70.030487],[-12.168226, -68.558703],[-11.113727, -67.701993],[-10.509417, -67.240687],[-8.885072, -68.339034],[-7.100893, -71.062933]]

    var shah_state = L.polygon(shah_state_lines, {color: 'red'});

    var bertol_state = L.polygon(bertol_state_lines, {color: 'red'});

    var merback_state = L.polygon(merback_state_lines, {color: 'red'});

    var iron_state = L.polygon(iron_state_lines, {color: 'grey'});

    var prusha_nation = L.polygon(prusha_nation_lines, {color: 'red'});

    var ducan_nation = L.polygon(ducan_empire_lines, {color: 'orange'});

    var vrecia_dynasty = L.polygon(vrecia_dynasty_lines, {color: 'yellow'});

    var krurian_kingdom = L.polygon(krurian_kingdom_lines, {color: 'green'});

    //blank image
    var blank_image = 'images/none.png',
      blank_bounds = [[84,-172], [85, -173]];
    var blank_icon = L.imageOverlay(blank_image, blank_bounds);

    //State Names as image layers
    var prusha_image = 'images/names/prusha.png',
      prusha_bounds = [[-14.946524, -86.813965], [-16.278474, -82.946777]];
    var prusha_name = L.imageOverlay(prusha_image, prusha_bounds);

    var shah_image = 'images/names/shah.png',
      shah_bounds = [[-9.4715, -86.220113], [-11.027765, -80.289043]];
    var shah_name = L.imageOverlay(shah_image, shah_bounds);

    var bertol_image = 'images/names/bertol.png',
      bertol_bounds = [[-9.298124, -77.191706],[-10.164115, -73.984534]]
    var bertol_name = L.imageOverlay(bertol_image, bertol_bounds);

    var merback_image = 'images/names/merback.png',
      merback_bounds = [[-11.070883, -94.809182],[-12.06079, -90.525631]]
    var merback_name = L.imageOverlay(merback_image, merback_bounds);

    var iron_state_image = 'images/names/iron_state.png',
      iron_state_bounds = [[-12.661778, -73.633063],[-13.218556, -70.909164]]
    var iron_state_name = L.imageOverlay(iron_state_image, iron_state_bounds);

    //Ducan Empire names
    var ducan_empire_image = 'images/names/ducan.png'
      ducan_empire_bounds = [[-51.764767, -45.791016],[-55.685101, -26.367188]]
    var ducan_empire_name = L.imageOverlay(ducan_empire_image, ducan_empire_bounds);

    //Vrecia Dynasty names
    var vrecia_dynasty_image = 'images/names/vrecia_dynasty.png'
      vrecia_dynasty_bounds = [[-6.753495, -15.135129],[-12.468603, 1.999075]]
    var vrecia_dynasty_name = L.imageOverlay(vrecia_dynasty_image, vrecia_dynasty_bounds);

    //Krurian Kingdom names
    var krurian_kingdom_image = 'images/names/krurian_kingdom.png'
      krurian_kingdom_bounds = [[-32.462286, -132.407227],[-34.874492, -118.212891]]
    var krurian_kingdom_name = L.imageOverlay(krurian_kingdom_image, krurian_kingdom_bounds);

    //Road Line Polylines
    var birch_galo = [[-10.681419, -72.290039],[-10.01213, -71.279297],[-10.01213, -68.422852],[-11.566144, -64.995117],[-13.154376, -62.402344],[-11.738302, -59.897461],[-10.574222, -58.842773],[-8.841651, -59.765565]];
    var candlekeep_tarcia = [[-23.235331, -90.395508],[-24.120158, -93.164063],[-24.440526, -95.800781]];

    // Markers Shah Provence
      var marker_arcane = L.marker([-14.455958, -83.71582], {icon: tower})
        marker_arcane.bindPopup('<img src="images/arcane_tower.jpg" width="300" height="200"><br><h1 style="color:red;font-size:20px;">The Tower of the Arcane Arts</h1><p>The Tower of the Arcane Arts is a bastion for all those seeking to develop their magical abilities. Those who pass the Trial of the Four Pillars are allowed access to the wonders inside.<p>');

      var marker_veritas = L.marker([-14.645909, -83.452148], {icon: port_town})
        marker_veritas.bindPopup('<img src="images/veritas.jpg" width="300" height="200"><br><h1 style="color:red;font-size:20px;">Veritas</h1><p>Veritas is a port city that is located at the base of a large hill. Sitting within the shadow of the tower that holds the Council of the Arcane Arts, Veritas is a bustling town with a number of buildings and people living within. It has a main road which leads from the port up towards the northern gate. Because it is a port town there are numerous people of varying races residing within. It has a population of about 9,000 people and while there are varying races most are either human or halfling. Exiting out of the town the road curves up and around the hill towards the north then west to an intersection, where travelling south up the hill leads to the tower of the Arcane Arts while travelling north leads to Wingston.<p><br><a href="veritas.html">Town Map</a>');

      var marker_wingston = L.marker([-13.304877, -83.847656], {icon: town})
        marker_wingston.bindPopup('<img src="images/wingston.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Wingston</h1><p>Wingston is a typical farming village with its sprawled out design and farmsteads Each building is only of a single storey in height save for The Barn located in the centre of the town. Several hours from the town is an apple orchard which is home to about 40 people who help maintain it.<p><br><a href="wingston.html">Town Map</a>')

      var marker_lancaster = L.marker([-12.275444, -85.583496], {icon: town})
        marker_lancaster.bindPopup('<img src="images/lancaster.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Lancaster</h1><p>Lancaster was once known for its flowers growing and selling many of their wares to the surrounding towns. The flowers were mostly sold for decorations to nobles but also for medical purposes as well as dyes. This, however, came to an end when the town was attacked by bandits and many of its residents were killed save for a handful. This handful was rescued by the tower all being women and children, all who currently reside in Polperro. However reconstruction has started on the town.<p><br><a href="lancaster.html">Town Map</a>')

      var marker_polperro = L.marker([-11.285739, -86.748047], {icon: town})
        marker_polperro.bindPopup('<img src="images/polperro.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Polperro</h1><p>Polperro has a reputation among the countryside and is known for having tough warriors, the best warriors for the Prusha Empire come from here. It is governed by a group of guild masters rather than a mayor. However, the general of the armies of Polperro has more weight in discussions and while not officially the mayor acts like one. The thick palisade walls stretch up 40-50 feet into the sky, the sharp-pointed wooden spikes have soldiers constantly patrolling.<p><br><a href="polperro.html">Town Map</a>')

      var marker_berxley = L.marker([-11.931814, -81.650391], {icon: town})
        marker_berxley.bindPopup('<img src="images/berxley.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Berxley</h1><p>Berxley is a small village which practices in farming, they are well known for their wheat production and sheep flocks. They produce much of the areas flour, and woollen goods. Most people within the town worship Bahamut.<p><br><a href="berxley.html">Town Map</a>')

      var marker_bereston = L.marker([-8.865105, -92.614746], {icon: town})
        marker_bereston.bindPopup('<img src="images/bereston.jpeg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Bereston</h1><p>Bereston is a small village build on stilts in the Bereston marsh. There are four small clusters of houses connected by scaffoldings. Tied to the poles of the scaffolding are little boats they use for fishing close to the city.<p><br><a href="bereston.html">Town Map</a>')

      var marker_hammerton = L.marker([-8.535501, -85.649414], {icon: city})
        marker_hammerton.bindPopup('<img src="images/hammerton.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Hammerton</h1><p>Hammerton is built into a small valley in the mountains that runs North-South. It is narrow so Hammerton is sometimes called the One Street Town. There is farmland build into the mountainside, but for the most part, it is a rest station for those travelling through the mountains to pass to the north side. Hammerton serves two functions. One an export of ore from the nearby mountain mines. Two it is a gateway rest to the mountain range for those wishing to travel over the mountains to the northern desert.<p><br><a href="hammerton.html">Town Map</a>')

      var marker_watford = L.marker([-14.326975, -86.000977], {icon: port_city})
        marker_watford.bindPopup('<img src="images/watford.jpeg" width="300" height="200" style="vertical-align:middle"><br><h1 style="color:red; font-size:20px;">Watford</h1><p>The city of Watford was built along the banks of a labyrinth of rivers and is truly an ancient metropolis. Its elegance is matched by the backdrop of lush forests which have helped shape the city to what it is today. The climate these forests brought was of great importance, but they were also influential when it came to architectural designs as the vast majority of buildings have been built with many natural elements to keep in line with the forests. The skyline is packed with soaring skyscrapers and their history seemed to shine more now than ever. Trade is at an all-time high in Watford and it has attracted a lot of attention. Many new cultures have left their mark not just on trade and relations, but also upon the citys identity. What historically was a city of predictability has grown into a fusion of everything and it is this that unites the people to this day. It is this multicultural identity that has truly left its mark. Hundreds of Diners, Taverns, Tea Shops, and Inns offer a plethora of culinary choices for those who feel hungry. There is something for everyone to enjoy nature, libraries, or one of the many recreational venues.<p><br><a href="watford.html">Town Map</a>', {maxWidth: 450})

      var marker_dartle = L.marker([-12.404163, -83.869629], {icon: town})
        marker_dartle.bindPopup('<img src="images/dartle.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Dartle</h1><p>Dartle is a small farming village that resides next to a dense forest.<p><br><a href="dartle.html">Town Map</a>')

      var marker_seer_shack = L.marker([-13.260836, -82.55127])
        marker_seer_shack.bindPopup('<img src="images/seer_shack.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">The Seers Shack</h1><p>Half a day east of wingston, lies a small shack inside a swampy area of the forest. In it lives a nameless hag referred to as "The Seer". Her appearance is that of a cross between tiefling and hag, her long lanky arms can extend all the way to the door of her home as she sits never moving from her chair.<p><br>')

      //Markers Bertol
      var marker_vex = L.marker([-10.162469, -77.651367], {icon: town})
        marker_vex.bindPopup('<img src="images/vex.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Vex</h1><p>Vex is a farming town with a military outpost near by. Being on the boarder of Shah and Bertrol states it manages much of the trade and boarder control. Vexs main production is oranges. They have many orchards growing around the outside and export a lot of what they grow.<p><br><a href="vex.html">Town Map</a>')

        var marker_gladmouth = L.marker([-10.530148, -75.915527], {icon: town})
          marker_gladmouth.bindPopup('<img src="images/gladmouth.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Gladmouth</h1><p>Gladmouth is known for its fashion and the nobility that live there. It is the place to be if you are wealthy and well off. Many nobles who choose to live here do so because of the abundance of land around the area and its local to the capital Gora. There are two sides to every coin though and there are rougher parts of the town which the nobility steer clear of calling it The Dark Half.<p><br><a href="vex.html">Town Map</a>')

        var marker_gora = L.marker([-12.532818, -75.410156], {icon: city})
          marker_gora.bindPopup('<img src="images/gora.png" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Gora</h1><p>Gora is the Capital of the Prushan Empire, the city itself is massive and the largest in Prusha. It is known for having immaculatily clean streets and a variety of stores and places to entertain oneself. The town tends to be home to much nobility wanting to be close to the King and his family. the city is built on a hill with the central castle being the main object of display. All roads lead towards the castle and the buildings surrounding the inner walls. A lot of time and effort has been spent of keeping the city looking as beautiful as possible.<p><br><a href="gora.html">Town Map</a>')

      //Merback Markers
      var marker_bearcall = L.marker([-18.017242, -96.833496], {icon: port_city})
          marker_bearcall.bindPopup('<img src="images/bearcall.jpeg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Bearcall</h1><p>Bearcall is a settlement that formed around The Pillars of the Storm. It lies close to the coast in the state of Merback. The city itself is home to many races with each person who grew up within its bounds being broader and stockier than others. People who grow up here are easily able to lift heavy barrels and move them about without the use of a cart. there are many soldiers about who do not wear uniforms. It houses a population of well over 100,000 individuals.<p><br><a href="bearcall.html">Town Map</a>')

      var marker_dawnshear = L.marker([-6.711202, -96.855469], {icon: city})
          marker_dawnshear.bindPopup('<img src="images/dawnshear.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Dawnshear</h1><p>The city of Dawnshear looms up from behind some trees. The city is made of mainly wooden buildings and for wherever you stand within the city you can seethe tree that lives in the center of the city. Walking around the streets you see goats and chickens walking around as well as a variety of flowers, trees and bushes. The city has a great respect for nature and the animals and feels inviting to those who hold the same views.<p><br><a href="dawnshear.html">Town Map</a>')

      var marker_coldford = L.marker([-15.070432, -100.129395], {icon: port_town})
          marker_coldford.bindPopup('<img src="images/coldford.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Coldford</h1><p>The little town of Coldford is on the route between Bearcall and Ilelion. The town is filled with large wooden logs. These logs are ready to be made into the ships which are made in this beautiful town. The citezens are rough and loud, most having suffered hearling loss while working on making these ships.<p><br><a href="coldford.html">Town Map</a>')

      var marker_ilelion = L.marker([-11.609408, -102.062988], {icon: town})
          marker_ilelion.bindPopup('<img src="images/ilelion.jpeg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Ilelion</h1><p>Ilelion is a city with a lot of people but very few buildings. The city itself is built around an open aired temple dedicated to Avandra. Ilelion is known for hosing some amazing events that holds a large number of people. The stadium is one of the largest buildings where said events are held. Most of the people live in tents, some of which are more permanent than others. Because of the temporary nature of the town it is often chaning, stores no longer being there and being replaced by other shopsor restaurants. <p><br><a href="coldford.html">Town Map</a>')

      var marker_oakenshell = L.marker([-13.773086, -97.404785], {icon: town})
          marker_oakenshell.bindPopup('<img src="images/oakenshell.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Oakenshell</h1><p>Oakenshell is a small town that is within a big forest. The town itself is located a bit off of the main road and has smal llanterns which decorate the road into town. The town is inhabited by forest gnomes and wood elves each who live in a little wooden cabin.<p><br><a href="oakenshell.html">Town Map</a>')

      var marker_yedif = L.marker([-13.666842, -92.746582], {icon: port_town})
          marker_yedif.bindPopup('<img src="images/yedif.jpeg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Yedif</h1><p>Yedif is a relatively small port town on the coast of the Merback region. Throughout the town there are various shrines to various gods. Most of the shrines are dedicated to Kord. The population mainly include humans, gnomes, and half orcs and is quite a small little town.<p><br><a href="oakenshell.html">Town Map</a>')

      var marker_bastion = L.marker([-4.780153, -99.360352], {icon: town})
          marker_bastion.bindPopup('<img src="images/bastion.jpg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">Bastion</h1><p>This town is not so much a town but a temple to Bahamut, the Platinum Dragon, and a town has produced itself around the temple. The temple is carved into the mountain and the town now resides on the hillside. The town is managed by the temple and thus functions more as a theocracy than anything else. The climb from the base of the town to the temple at the top covers some 1500 vertical feet, and the base elevation of the town is around 2000 ft. Often the journey up takes as much as a day due to switchbacks and elevation change, and why the town has an inn at the base and an inn at the top of the mountain. There are lifts that are used for supplies and for people that are not making the religious trek. Those that walk The Dragons Spine are considered to be faithful and devout, and worthy of acceptance into the Temples service.<p><br><a href="bastion.html">Town Map</a>')

      var marker_red_mountain = L.marker([-8.561207, -112.412109])
          marker_red_mountain.bindPopup('<img src="images/red_mountain.jpeg" width="300" height="200"><br><h1 style="color:red; font-size:20px;">The Red Mountain</h1><p>Residing in the mountain range west of Ilelion is the red mountain, sticking out from the rest due to a certain mineral giving it a red hue. Legend states an ancient being lives among the wildlife here giving a voice to the animals.<p><br>')

      //The Iron State markers
      var marker_birch = L.marker([-10.681419, -72.290039], {icon: city})
          marker_birch.bindPopup('<img src="images/birch.jpg" width="300" height="200"><br><h1 style="color:grey; font-size:20px;">Birch</h1><p>Birch is hillside town that has a well defendable location on the top of a hill. It is known for having anotable smithing academy and its residents enjoy wearing fashonable clothing. Much of which they import from Gladmouth. Due to being in the Iron State the city is well prepared for war if the need would arise. With all its guards having iron armor and weapons as well as balista and other weapons on the walls of the city. The town is mostly dwarves with a few other races being found inside of the walls. <p><br><a href="birch.html">Town Map</a>')

      //Krurian Kingdom
      var marker_candlekeep = L.marker([-23.235331, -90.395508], {icon: city})
          marker_candlekeep.bindPopup('<img src="images/candlekeep.jpg" width="300" height="200"><br><h1 style="color:green; font-size:20px;">Candlekeep</h1><p>Candlekeep is a medium sized town that takes up a small amount of space. It has buildings which are built up to at least 3 storeys and are all compactly put together. It is known for its large library and commonly hosts scholars from around the area to learn from the books that are kept within.<p><br><a href="candlekeep.html">Town Map</a>');
      var marker_tarcia = L.marker([-24.440526, -95.800781], {icon: town})
          marker_tarcia.bindPopup('<img src="images/tarcia.jpg" width="300" height="200"><br><h1 style="color:green; font-size:20px;">Tarkia</h1><p>Tarcia is a small forest town filled strictly with elves, population is rather small and the elves here generally keep to themselves not venturing out of their town. Happy to lead their lives away from other towns and races. The town is completly self sufficient using amixture of magic and fine craftsmanship to provide all of its necessities.<p><br><a href="tarcia.html">Town Map</a>');
      var marker_leondra = L.marker([-40.198948, -102.788086], {icon: town})
          marker_leondra.bindPopup('<img src="images/leondra.jpg" width="300" height="200"><br><h1 style="color:green; font-size:20px;">Leondra</h1><p>Leondra is a brand new settlement currently in development, dozens of leonin who were displaced from their homes settled in this unclaimed territory and began making a new home for themselves.<p><br><a href="leondra.html">Town Map</a>');
      var marker_treetop_burgh = L.marker([-18.812718, -118.388672], {icon: city})
          marker_treetop_burgh.bindPopup('<img src="images/treetop_burgh.jpg" width="300" height="200"><br><h1 style="color:green; font-size:20px;">Treetop Burgh</h1><p>Treetop Burgh is a name given to the city by explorers and far travelers. The city is primarly inhabited by Firbolgs, though elves and humans call this place home as well. Homes are built into the roots of massive ancient trees, while other stone structures are built against them. The city is truly symbiotic in nature, as the trees protect its people from the awful shadow creatures that bleed through from the shadowfell while the people protect the trees from outsiders and those who would seek the rare wood they are made of.<p><br><a href="treetop_burgh.html">Town Map</a>');
      var marker_the_y_stop = L.marker([-14.755098, -119.047852], {icon: tree})
          marker_the_y_stop.bindPopup('<img src="images/the_y_stop.jpg" width="300" height="200"><br><h1 style="color:green; font-size:20px;">The Y Stop</h1><p>Built within the boughs of trees, the "Y" stop is a place of rest for travelers wishing to explore the mountain range or the various ruins nearby. Its name is in reference to the convergence of two small rivers, which the "Y" stop is structured over. Residents are few, as the majority of the population only stays long enough to recuperate before moving on to their intended destination.<p><br><a href="the_y_stop.html">Town Map</a>');
      var marker_bar_anor = L.marker([-34.452218, -112.631836], {icon: port_city})
          marker_bar_anor.bindPopup('<img src="images/bar-anor.jpg" width="300" height="200"><br><h1 style="color:green; font-size:20px;">Bar-Anor</h1><p>Bar-Anor is the city of the Sun Elves. This high walled city has two official entrances, the road into Guard Home, and the road known locally as Beggars Street.  The city is majority tan skinned copper haired elves, though other races are not lacking in the census. In the South near the fruit orchard eave, lies the tall castle home to the ruling line of Sun elves. <p><br><a href="bar-anor.html">Town Map</a>');
      var marker_bar_ithil = L.marker([-42.956423, -131.572266], {icon: city})
          marker_bar_ithil.bindPopup('<img src="images/bar-ithil.jpg" width="300" height="200"><br><h1 style="color:green; font-size:20px;">Bar-Ithil</h1><p>Bar-Ithil is the home of the Moon Elves.  These fair skinned fair haired elves in this city have no port and instead try to produce their own goods in their city.  Other races are present in the city, however due to the narrow streets, large carts and orders cannot be brought past the Southern Gate, where many have built shops to protect carts of travelers. <p><br><a href="bar-ithil.html">Town Map</a>');
      var marker_frost_pass = L.marker([-45.274886, -115.048828], {icon: town})
          marker_frost_pass.bindPopup('<img src="images/frost_pass.jpg" width="300" height="200"><br><h1 style="color:green; font-size:20px;">Frost Pass</h1><p>This nomadic camp crosses the tundra between the temperate zone to the north, and the frozen south. Many races congregate here.  The political structure is fluid, the leader is selected whenever a problem arises which requires one. <p><br><a href="frost_pass.html">Town Map</a>');

      var marker_ashford = L.marker([-25.403585, -128.781738], {icon: port_city})
        marker_ashford.bindPopup('<img src="images/ashford.png" width="300" height="200"><br><h1 style="color:green; font-size:20px;">Ashford</h1><p>Ashford is a busy port city on the northern end of the ?? sea.<p><br><a href="ashford.html">Town Map</a>');

      //Ducan Empire
      var marker_lochhaven = L.marker([-58.881942, -10.283232], {icon: port_town})
          marker_lochhaven.bindPopup('<img src="images/lochhaven.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Lochhaven</h1><p>Lochhaven is a town populated by mostly humans however spattering a of other races have come to make their home in this fair town. It is a small town with only 5,000 residents living within its walls. The town is located on a river, houses rising on both sides with a great bridge dividing the East side and West side. Lochhavens main export is wood. It has a rich history of loggers who provide high quality wood to other towns in the area. Demographically richer residence live on the East side of the bridge while the west side tends to be more lower class.<p><br><a href="lochhaven.html">Town Map</a>')

      var marker_lowood = L.marker([-58.665513, -13.270734], {icon: town})
          marker_lowood.bindPopup('<img src="images/lowood.png" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Lowood</h1><p>Lowood is a small town with a small population of only just over 200 people. It is mostly humans with the occasional member of another race showing up. It is mostly self sufficient without exporting any goods of real value. But does occasional trade with passersby when they come through on their way from Lochhaven to Wandermere or Wolfspine.<p><br><a href="lowood.html">Town Map</a>')

      var marker_wandermere = L.marker([-58.159112, -18.081491], {icon: town})
          marker_wandermere.bindPopup('<img src="images/wandermere.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Wandermere</h1><p>Wandermere has an awful smell, and is known for dark magic. The ruler is fair and just, respected by the populace. Humans are the prevelant race here with halfling being the second most popular followed by elves. They have a small population housing just over 440 people.<p><br><a href="wandermere.html">Town Map</a>')

      var marker_wolfspine = L.marker([-54.533833, -14.918254], {icon: town})
        marker_wolfspine.bindPopup('<img src="images/wolfspine.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Wolfspine</h1><p>Wolfspine is the capital of the Ducan Empire and the largest city within that area. It houses just over 81,000 people of all different races. It covers 1,318 acres of land and rests upon the Sullies River which flows through the city itself out to sea. The city is home to a lot of political intrigue. The races live together mostly in harmony.<p><br><a href="wolfspine.html">Town Map</a>')

      var marker_wakefield = L.marker([-58.539595, -1.276791], {icon: town})
        marker_wakefield.bindPopup('<img src="images/wakefield.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Wakefield</h1><p>Wakefield is a small farming town which sits on either side of the river. The people here are good farming folk and are mostly halflings and humans. Their population is under 100 individuals.<p><br><a href="wakefield.html">Town Map</a>')

      var marker_alnwick = L.marker([-61.74193, -5.736078], {icon: town})
        marker_alnwick.bindPopup('<img src="images/alnwick.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Alnwick</h1><p>Alnwick houses a population of just over 5,000 individuals with most of them being halfling and elves, there are very few humans within this settlement. The town itself is mostly rundown with the ruler not taking care of the buildings or streets instead caring more for their own needs instead. The guards are heavy handed being more cruel then gracious.<p><br><a href="alnwick.html">Town Map</a>')

      var marker_baulders_deep = L.marker([-60.03193, 8.542425], {icon: town})
        marker_baulders_deep.bindPopup('<img src="images/baulders_deep.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Baulders Deep</h1><p>Baulders Deep has a population of about 1,500 people. They are known for their strong drink and are known for their stone working academy. People come from all around to come and train underneath the masters of stonework. Baulders Deep is carved out of a large boulder in the side of a mountain with an attached port which is also carved out of the large bauldering stonework.<p><br><a href="baulders_deep.html">Town Map</a>')

      var marker_black_hollows = L.marker([-39.993956, -21.068993], {icon: town})
        marker_black_hollows.bindPopup('<img src="images/black_hollows.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Black Hollows</h1><p>Black Hallows sits in the shadow of a large ruined castle, and is known for having hordes of beggars. The ruler is a feared tyrant who rules over the town with a firm hand. There is some tension between the races but this is mainly due to the stress of living in such a town under a ruler such as they have. The people worship an ancient bird known as the Phoenix and are continuing to pray to it to remove the Tyrant. <p><br><a href="black_hollows.html">Town Map</a>')

      var marker_moonbright = L.marker([-45.813486, -36.555678], {icon: town})
        marker_moonbright.bindPopup('<img src="images/moonbright.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Moonbright</h1><p>Moonright is a small town that is an average sized town with strong battlements. It has a nearby forest where creatures of strange origin appear and attackthe village periodically. The creatures are low in number and easily killed. The town has made a sport of it and holds contents to see how many of such creatures can be killed within a certain time. The forest which they come from is seen as sacred and nobody enters in to inspect for fear of the creatres stopping and their culture no longer being as it is.<p><br><a href="moonbright.html">Town Map</a>')

      var marker_PF_monestary = L.marker([-35.119909, -36.006504], {icon: town})
        marker_PF_monestary.bindPopup('<img src="images/PF_monestary.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">The Petrified Forest Monestary</h1><p>The Petrified Forest Monestary is built into a the mountain that is at the edge of the Petrified Forest. The trees in the forest not actually being made of stone but because of the mineral deposits around create a very hard wood. Which is favoured by wood workers around the nation. The Monestar houses people looking to develop their martial arts prowess, training underneath the masters and developing the damage of the strikes by hitting the trees.<p><br><a href="PF_monestary.html">Town Map</a>')

      var marker_northin = L.marker([-33.596319, -38.891647], {icon: town})
        marker_northin.bindPopup('<img src="images/northin.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Northin</h1><p>Northin is a town just north of the Petrified Forest and makes much of their business out of chopping down the trees and transporting them to other locations. The wood crafters here are particularily skilled at carving and using the wood.<p><br><a href="northin.html">Town Map</a>')

      // Vrecia Dynasty
      var marker_sun_temple = L.marker([-0.028652, -57.348633], {icon: town})
        marker_sun_temple.bindPopup('<img src="images/sun_temple.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Sun Temple</h1><p>The Sun temple is a temple that is dedicated to the worship of the sun.<p><br><a href="sun_temple.html">Town Map</a>')

      var marker_galo = L.marker([-8.841651, -59.765565], {icon: town})
        marker_galo.bindPopup('<img src="images/galo.jpg" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Galo</h1><p>Galo is a trading post set in the desert containing supplies many would need for the trek into the harsh sand dunes.<p><br><a href="galo.html">Town Map</a>')

      var marker_vrecia = L.marker([0.432514, -4.130859], {icon: port_city})
        marker_vrecia.bindPopup('<img src="images/vrecia.png" width="300" height="200"><br><h1 style="color:orange; font-size:20px;">Vrecia</h1><p>The Vrecian Dynasty is ruled by Queen Vrecia the 12th, both beautiful and dangerous she rules with absolute authority. Renown around the world for their silks, and markets the walled city of Vrecia is famous for its trade. Any merchant vessel hoping to make good coin knows to add Vrecia to their route. Here, you will find that favors offer just as much value as coin.<p><br><a href="vrecia.html">Town Map</a>')

      // Underdark locations
      var marker_abterra_the_purple_city = L.marker([-12.082296, -135.021973], {icon: town})
        marker_abterra_the_purple_city.bindPopup('<img src="images/abterra_the_purple_city.jpg" width="300" height="200"><br><h1 style="color:green; font-size:20px;">Abterra - The Purple City</h1><p>Abterra- independent city, formed 300 years ago by an adventuring party. As they settled they founded a council to maintain order and peace in the city. Ruled by a retired adventuring party, the city has flourished during its peaceful time.<p><br><a href="abterra_the_purple_city.html">Town Map</a>');

      // Future Tower Location

      var marker_arcane_future = L.marker([-28.098749, -108.28125], {icon: tower})
        marker_arcane_future.bindPopup('<img src="images/arcane_tower.jpg" width="300" height="200"><br><h1 style="color:red;font-size:20px;">The Tower of the Arcane Arts</h1><p>The Tower of the Arcane Arts is a bastion for all those seeking to develop their magical abilities. Those who pass the Trial of the Four Pillars are allowed access to the wonders inside.<p>');

      //Moveable Marker
      var marker  = L.marker([-11.994986, -83.95752], {
        draggable: true,
      })
        marker.bindPopup('');

      marker.on('dragend', function(e) {
        marker.getPopup().setContent('Clicked' + marker.getLatLng().toString()).openOn(map);
      });

    //Roads
      var road_1 = L.polyline(birch_galo, {color: '#9b7653', weight: 2}).addTo(map);
      var road_2 = L.polyline(candlekeep_tarcia, {color: '#9b7653', weight: 2}).addTo(map);

    //Layer Groups
      var lg_roads = L.layerGroup([road_1,road_2]);

      var lg_towns = L.layerGroup([marker, marker_arcane, marker_veritas, marker_wingston, marker_watford, marker_lancaster, marker_polperro, marker_berxley, marker_bereston, marker_hammerton, marker_vex, marker_gladmouth, marker_gora, marker_birch, marker_bearcall, marker_dawnshear, marker_coldford, marker_ilelion, marker_oakenshell, marker_yedif, marker_bastion, marker_lochhaven, marker_lowood, marker_wandermere, marker_wolfspine, marker_wakefield, marker_alnwick, marker_baulders_deep, marker_black_hollows, marker_moonbright, marker_PF_monestary, marker_northin, marker_candlekeep, marker_tarcia, marker_dartle, marker_red_mountain, marker_seer_shack, marker_sun_temple, marker_galo, marker_vrecia, marker_leondra, marker_arcane_future, marker_treetop_burgh, marker_the_y_stop, marker_bar_anor, marker_bar_ithil, marker_frost_pass,marker_ashford]);

      var lg_states = L.layerGroup([shah_state,shah_name,bertol_state,bertol_name,merback_state,merback_name,iron_state,iron_state_name]);

      var lg_nations = L.layerGroup([prusha_nation,prusha_name,iron_state,iron_state_name,ducan_nation,ducan_empire_name,vrecia_dynasty,vrecia_dynasty_name, krurian_kingdom, krurian_kingdom_name]);

      var lg_UdTowns =
        L.layerGroup([marker_abterra_the_purple_city])

      var baselays = {
        "Underdark": underdark,
        "Overworld": overworld
      };

      var overlays = {
        "Overworld Locations": lg_towns,
        "Underdark Locations": lg_UdTowns,
        "Roads": lg_roads,
        "States": lg_states,
        "Nations": lg_nations,
      };

      map.on('zoomend', function(e) {
        var geo = map.getCenter();
        console.log(map.getZoom());
        if (map.getZoom()>=5)
        {
          lg_towns.addTo(map);
        }else {
          lg_towns.remove();
        }
      });

    map.on('baselayerchange', function (e) {
      console.log(e.layer);
      if (e.layer=='underdark')
      {
        L.control.layers(baselays, overlays).removeLayer(overlays);
      }else {
        L.control.layer(baselays, overlays).addOverlay(overlays);
      }
      });
    // Add Layer Control
      L.control.layers(baselays, overlays).addTo(map);


    </script>

  </body>
</html>
